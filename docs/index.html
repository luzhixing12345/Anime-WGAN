<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
        Document
    </title>
    <link rel='stylesheet' href=./css/prism.css /><link rel='stylesheet' href=./css/index.css />
    <link rel="icon" href="https://raw.githubusercontent.com/learner-lu/picbed/master/logo.png">
</head>

<body class="light">
    <a href="https://github.com/luzhixing12345/Anime-WGAN.git" target="_blank" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
    <div class="header-navigator"><ul><li><a href="#h1-0">Anime-WGAN-GP</a><ul><li><a href="#h2-1">Introduction</a></li></ul><ul><li><a href="#h2-2">Requirements</a></li></ul><ul><li><a href="#h2-3">Dataset</a></li></ul><ul><li><a href="#h2-4">Use</a><ul><li><a href="#h3-5">Train</a></li></ul><ul><li><a href="#h3-6">Generate images</a></li></ul></li></ul><ul><li><a href="#h2-7">Pretrained model</a></li></ul><ul><li><a href="#h2-8">Result</a></li></ul><ul><li><a href="#h2-9">Conclusion</a></li></ul><ul><li><a href="#h2-10">Relevant reference</a></li></ul></li></ul></div><div class='markdown-body'><h1 id="h1-0">Anime-WGAN-GP</h1><p><img src="https://raw.githubusercontent.com/learner-lu/picbed/master/WGAN64_anime.png" alt="WGAN64_anime"></p><h2 id="h2-1">Introduction</h2><p>Anime-WGAN-GP 是一个使用 WGAN-GP 来生成动漫头像的项目</p><p>相关视频: <a href="https://www.bilibili.com/video/BV1cr4y147s8" target="_blank">【项目分享】使用GAN网络生成动漫头像(附代码)</a></p><h2 id="h2-2">Requirements</h2><ul><li>python : 3.7</li></ul><ul><li><a href="https://pytorch.org/get-started/previous-versions/" target="_blank">pytorch</a><pre><code class="language-bash"># CUDA 10.2
conda install pytorch==1.10.1 torchvision==0.11.2 torchaudio==0.10.1 cudatoolkit=10.2 -c pytorch</code></pre></li></ul><ul><li>other dependencies<pre><code class="language-bash">pip install -r requirements.txt</code></pre></li></ul><h2 id="h2-3">Dataset</h2><ul><li><a href="https://github.com/luzhixing12345/anime-face-dataset/releases/download/v0.0.1/anime256.zip" target="_blank">anime256</a><p>整个数据集包含 2.7w+ 分辨率为 256x256 的高质量动漫人脸</p><blockquote><p><a href="https://github.com/luzhixing12345/anime-face-dataset" target="_blank">https://github.com/luzhixing12345/anime-face-dataset</a></p></blockquote></li></ul><ul><li><a href="https://github.com/luzhixing12345/Anime-WGAN/releases/download/v0.0.2/faces.zip" target="_blank">anime</a><p>另一个数据集,5w+,分辨率96x96,质量不错</p></li></ul><p>下载zip并且解压到 <code>./dataset</code> 文件夹下, <code>dataset/anime256</code> and <code>dataset/anime</code></p><blockquote><p>如果下载过慢可以使用<a href="https://ghproxy.com/" target="_blank">Github proxy</a>加速</p><p>这两个数据集下载任意一个用于训练都可以</p></blockquote><h2 id="h2-4">Use</h2><h3 id="h3-5">Train</h3><p>设计了两个模型结构, <code>WGAN</code> 和 <code>WGANP</code>, 这两个模型最主要的区别在于Generator增大图片尺寸的方式,你可以通过这篇文章<a href="https://distill.pub/2016/deconv-checkerboard/" target="_blank">反卷积存在的问题</a>了解到为什么要这么做</p><ul><li>run WGAN model as<pre><code class="language-bash">python train.py --config-file configs/WGAN.yaml</code></pre></li></ul><ul><li>run WGANP model as<pre><code class="language-bash">python train.py --config-file configs/WGANP.yaml</code></pre></li></ul><p><b>注意</b>: 如果需要自己训练模型,请参阅<a href="./train-info.md" target="_blank">更多训练信息</a>,当然你可以在后面找到提供的预训练模型</p><h3 id="h3-6">Generate images</h3><ul><li>use WGAN model as<pre><code class="language-bash">python generate.py --config-file configs/WGAN.yaml -g checkpoints/WGAN/WGAN_G_epoch_39999.pth</code></pre></li></ul><ul><li>use WGANP model as<pre><code class="language-bash">python generate.py --config-file configs/WGANP.yaml -g checkpoints/WGANP/WGANP_G_epoch_39999.pth</code></pre></li></ul><ul><li>use CPU<pre><code class="language-bash">python generate.py --config-file configs/WGANP.yaml -g checkpoints/WGANP_G_ANIME256.pth MODEL.DEVICE cpu</code></pre></li></ul><p>默认情况下,它会在 <code>./images</code> 下生成一个 8x8 网格的动漫图片</p><p>其他:</p><ul><li><code>-g</code>: generator 的缩写,一个参数是模型权重的路径名<p><b>这里的模型是指生成器G的模型</b></p></li></ul><ul><li><code>-s</code>: separate 的缩写,没有参数<p>可以使用<code>-s</code>将将一张大图拆分成每一张小图</p></li></ul><h2 id="h2-7">Pretrained model</h2><ul><li>software<pre><code class="language-txt">OS: CentOS 7.5 Linux X86_64
Python: 3.7.14 (anaconda)
PyTorch: 1.10.1</code></pre></li></ul><ul><li>hardware<pre><code class="language-txt">CPU: Intel Xeon 6226R
GPU: Nvidia Tesla V100 16GB</code></pre></li></ul><table><tr><th>model</th><th>dataset</th><th>Discriminator</th><th>Generator</th></tr><tr><td style="text-align:center">                WGAN</td><td style="text-align:center">                ANIME256</td><td style="text-align:center">                <a href="https://github.com/luzhixing12345/Anime-WGAN/releases/download/v0.0.4/WGAN_D_ANIME256.pth" target="_blank">download</a></td><td style="text-align:center">                <a href="https://github.com/luzhixing12345/Anime-WGAN/releases/download/v0.0.4/WGAN_G_ANIME256.pth" target="_blank">download</a></td></tr><tr><td style="text-align:center">                </td><td style="text-align:center">                ANIME</td><td style="text-align:center">                <a href="https://github.com/luzhixing12345/Anime-WGAN/releases/download/v0.0.4/WGAN_D_ANIME.pth" target="_blank">download</a></td><td style="text-align:center">                <a href="https://github.com/luzhixing12345/Anime-WGAN/releases/download/v0.0.4/WGAN_G_ANIME.pth" target="_blank">download</a></td></tr><tr><td style="text-align:center">                WGANP</td><td style="text-align:center">                ANIME256</td><td style="text-align:center">                <a href="https://github.com/luzhixing12345/Anime-WGAN/releases/download/v0.0.4/WGANP_D_ANIME256.pth" target="_blank">download</a></td><td style="text-align:center">                <a href="https://github.com/luzhixing12345/Anime-WGAN/releases/download/v0.0.4/WGANP_G_ANIME256.pth" target="_blank">download</a></td></tr><tr><td style="text-align:center">                </td><td style="text-align:center">                ANIME</td><td style="text-align:center">                <a href="https://github.com/luzhixing12345/Anime-WGAN/releases/download/v0.0.4/WGANP_D_ANIME.pth" target="_blank">download</a></td><td style="text-align:center">                <a href="https://github.com/luzhixing12345/Anime-WGAN/releases/download/v0.0.4/WGANP_G_ANIME.pth" target="_blank">download</a></td></tr></table><p>如果不想自己训练(大约36~48h),可以下载预训练好的模型G并将其移动到<code>./checkpoints</code>下,然后按照上文<code>Generate images</code>生成图片, <b>注意修改后面的生成器G的模型路径</b></p><blockquote><p>事实上如果你只是想生成一张动漫图片你只需要下载G, 判别器D在生成图片的过程中并没有用到</p></blockquote><h2 id="h2-8">Result</h2><ul><li>generated fake images<blockquote><p>其实不是所有生成的图片都好看,手动选择了一些喜欢的图片,使用模型 <code>WGAN + anime256</code></p></blockquote><p><img src="https://raw.githubusercontent.com/learner-lu/picbed/master/7.png" alt="7"> <img src="https://raw.githubusercontent.com/learner-lu/picbed/master/33.png" alt="33"> <img src="https://raw.githubusercontent.com/learner-lu/picbed/master/61.png" alt="61"> <img src="https://raw.githubusercontent.com/learner-lu/picbed/master/18.png" alt="18"> <img src="https://raw.githubusercontent.com/learner-lu/picbed/master/12.png" alt="12"> <img src="https://raw.githubusercontent.com/learner-lu/picbed/master/13.png" alt="13"></p></li></ul><ul><li>walking latent space<blockquote><p>如果尚不了解潜在空间探索可以参考<a href="https://luzhixing12345.github.io/2022/05/18/GAN/GAN%E7%BD%91%E7%BB%9C%E8%AF%A6%E8%A7%A3(%E4%BA%8C" target="_blank">博客</a>/)</p></blockquote><table><tr><th>WGAN + anime256</th><th>WGAN + anime</th></tr><tr><td style="text-align:center">                <img src="https://raw.githubusercontent.com/learner-lu/picbed/master/walking_latent_space.gif" alt="1"></td><td style="text-align:center">                <img src="https://raw.githubusercontent.com/learner-lu/picbed/master/asdoqi.gif" alt="asdoqi"></td></tr></table><table><tr><th>WGANP + anime256</th><th>WGANP + anime</th></tr><tr><td style="text-align:center">                <img src="https://raw.githubusercontent.com/learner-lu/picbed/master/asdhjono.gif" alt="asdhjono"></td><td style="text-align:center">                <img src="https://raw.githubusercontent.com/learner-lu/picbed/master/hcouga.gif" alt="hcouga"></td></tr></table></li></ul><ul><li>GAN training process<blockquote><p>对于相同的噪声输入,不同生成图像的过程</p></blockquote><table><tr><th>WGAN + anime256</th><th>WGAN + anime</th></tr><tr><td style="text-align:center">                <img src="https://raw.githubusercontent.com/learner-lu/picbed/master/ANIME256_process.gif" alt="ANIME256_process"></td><td style="text-align:center">                <img src="https://raw.githubusercontent.com/learner-lu/picbed/master/WGAN64_anime_process.gif" alt="WGAN64_anime_process"></td></tr></table><table><tr><th>WGANP + anime256</th><th>WGANP + anime</th></tr><tr><td style="text-align:center">                <img src="https://raw.githubusercontent.com/learner-lu/picbed/master/ANIME256P_process.gif" alt="ANIME256P_process"></td><td style="text-align:center">                <img src="https://raw.githubusercontent.com/learner-lu/picbed/master/WGAN64P_anime_process.gif" alt="WGAN64P_anime_process"></td></tr></table></li></ul><h2 id="h2-9">Conclusion</h2><p>这是第一次尝试GAN,久闻大名但从未尝试学习它.恰逢<a href="https://github.com/luzhixing12345/data-science-introduction" target="_blank">数据科学导论</a>课期末报告,期末作业是做一些与机器学习相关的事情.所以这是学习 GAN 的好机会!于是看了一些GAN的论文,真的很有意思.</p><p><a href="https://zhuanlan.zhihu.com/p/24767059" target="_blank">GAN学习指南:从原理入门到制作生成Demo</a>启发了尝试生成自己的动漫头像</p><p>实际上必须承认,的预训练模型并没有像期待的那样表现出色,时至今日有很多优秀的模型在生成图像上具有更好的效果,比如diffusion.</p><p>这个项目的最初目的只是为了学习一些关于 GAN 的东西,选择使用 WGAN-GP 是因为它的数学推导很棒,想尝试动手写一下而不是只是双击运行,那样稍显无趣.</p><p>特别感谢 <a href="https://github.com/Zeleni9/pytorch-wgan" target="_blank">pytorch-wgan</a>,绝大部分代码都参考自这个项目</p><p>其实一开始想生成 256x256 的图像,这就是为什么爬取 256x256 图像并制作该数据集的原因.但随着图像尺寸乘以 4,模型表现极差.也许需要一个更好的模型结构.试过使用residual block ,但效果不佳.</p><h2 id="h2-10">Relevant reference</h2><p>project:</p><ul><li><a href="https://github.com/Zeleni9/pytorch-wgan" target="_blank">Github-GAN+DCGAN+WGAN-pytorch</a> (easy to use,recommand)</li></ul><ul><li><a href="https://github.com/eriklindernoren/PyTorch-GAN" target="_blank">Github-GAN*-pytorch</a> (overall)</li></ul><ul><li><a href="https://github.com/carpedm20/DCGAN-tensorflow" target="_blank">Github-DCGAN-tensorflow</a></li></ul><ul><li><a href="https://github.com/YadiraF/GAN" target="_blank">Github-GAN*-tensorflow</a></li></ul><p>knowledge:</p><ul><li><a href="https://zhuanlan.zhihu.com/p/24767059" target="_blank">GAN学习指南:从原理入门到制作生成Demo</a></li></ul><ul><li><a href="https://www.bilibili.com/video/BV1rb4y187vD" target="_blank">GAN论文逐段精读【论文精读】</a></li></ul><ul><li><a href="https://zhuanlan.zhihu.com/p/365400000" target="_blank">【数学知识】KL散度</a></li></ul><ul><li><a href="https://github.com/martinarjovsky/WassersteinGAN/blob/master/models/dcgan.py" target="_blank">WGAN-DCGAN</a></li></ul><ul><li><a href="https://github.com/EmilienDupont/wgan-gp" target="_blank">WGAN-GP</a></li></ul><ul><li><a href="https://zhuanlan.zhihu.com/p/28407948?ivk_sa=1024320u" target="_blank">[Paper] DCGAN论文精读笔记</a></li></ul><ul><li><a href="https://zhuanlan.zhihu.com/p/432965561" target="_blank">IS、FID、PPL,GAN网络评估指标</a></li></ul><ul><li><a href="https://zhuanlan.zhihu.com/p/25071913" target="_blank">令人拍案叫绝的Wasserstein GAN</a></li></ul><ul><li><a href="https://zhuanlan.zhihu.com/p/58260684" target="_blank">WGAN的来龙去脉</a></li></ul><ul><li><a href="https://arxiv.org/pdf/1708.05509.pdf" target="_blank">生成ANIMEfaces</a></li></ul><ul><li><a href="https://distill.pub/2016/deconv-checkerboard/" target="_blank">checkerboard</a></li></ul><ul><li><a href="https://zhuanlan.zhihu.com/p/58260684" target="_blank">WGAN的来龙去脉</a></li></ul><ul><li><a href="https://make.girls.moe/#/" target="_blank">girls make</a></li></ul><ul><li><a href="https://www.zhihu.com/search?type=content&q=latent%20walk" target="_blank">潜在空间探索</a></li></ul></div>
    <div class="dir-tree"><ul><li><a href="./articles/md-docs/README" >README</a></li></ul><ul><li><a href="./articles/md-docs/基本原理及数学推导" >基本原理及数学推导</a></li></ul><ul><li><a href="./articles/md-docs/DCGAN以及GAN网络存在的一些问题" >DCGAN以及GAN网络存在的一些问题</a></li></ul><ul><li><a href="./articles/md-docs/WGAN-CP 与 WGAN-GP" >WGAN-CP 与 WGAN-GP</a></li></ul><ul><li><a href="./articles/md-docs/使用WGAN生成动漫头像" >使用WGAN生成动漫头像</a></li></ul></div>
    <div class="zood"><a class="" href="https://github.com/luzhixing12345/zood" target="_blank">zood</a></div>
    <script type="text/javascript" src="./js/next_front.js"></script><script>addLink(".","./articles/md-docs/基本原理及数学推导","b")</script><script type="text/javascript" src="./js/change_mode.js"></script><script>addChangeModeButton("./img/sun.png","./img/moon.png")</script><script type="text/javascript" src="./js/copy_code.js"></script><script>addCodeCopy("./img/before_copy.png","./img/after_copy.png")</script><script type="text/javascript" src="./js/navigator.js"></script><script type="text/javascript" src="./js/prism.js"></script><script type="text/javascript" src="./js/picture_preview.js"></script>
        <script>
            MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\(', '\)']]
            }
            };
            </script>
        <script id="MathJax-script" async
        src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
        </script>
        <script type="text/javascript" src="./js/check_box.js"></script>
</body>

</html>